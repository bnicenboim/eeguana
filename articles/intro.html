<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction - Preprocessing and visualization of EEG data • eeguana</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction - Preprocessing and visualization of EEG data">
<meta property="og:description" content="eeguana">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eeguana</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Introduction - Preprocessing and visualization of EEG data</a>
    </li>
    <li>
      <a href="../articles/preprocessing_erp.html">Another example from a Fieldtrip tutorial: Preprocessing of EEG data and computing ERPs</a>
    </li>
    <li>
      <a href="../articles/gotchas.html">Pitfalls and gotchas</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bnicenboim/eeguana" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction - Preprocessing and visualization of EEG data</h1>
                        <h4 data-toc-skip class="author">Bruno Nicenboim</h4>
            
            <h4 data-toc-skip class="date">2022-01-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bnicenboim/eeguana/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>The package <em>eeguana</em> provides a framework for doing simple pre-processing with specialized functions and manipulating EEG data with <em>dplyr</em> verbs (e.g., <code>eeg_mutate</code>, <code>eeg_filter</code>, <code>eeg_summarize</code>) extended to a new class <code>eeg_lst</code>, and <code>ggplot</code> wrapper functions. The new class is inspired by tidyverse principles but it’s not really “tidy” (due to space considerations), it’s a list of (i) a wide table that contains the signal amplitudes at every sample point of the EEG, (ii) an events table with information about markers (or triggers), blinks and other exported information, and (iii) a long table with experimental information, such as participant (<code>recording</code>), conditions, etc.</p>
<p>While it’s possible to transform the <code>eeg_lst</code> to a <code>data.frame</code>, <code>data.table</code> or a <code>tibble</code> (with <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code>, <code>as.data.table()</code> and <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble()</a></code>), the motivation for manipulating the data in the <code>eeg_lst</code> format has to do with size considerations. In this case, the original file was 113 MB, converting it to a long format entails a lot of repetition and generates an object of 556 MB. While this will still work here, a long format quickly becomes prohibitive in real settings with longer recordings.</p>
<div class="section level2">
<h2 id="working-with-eeguana">Working with eeguana<a class="anchor" aria-label="anchor" href="#working-with-eeguana"></a>
</h2>
<p>Dplyr-like verbs always return an <code>eeg_lst</code> object, which allows us to use <code>magrittr</code>’s pipe, <code>%&gt;%</code> (see <code>?`dplyr-eeguana`</code>) or the new R pipe <code>|&gt;</code>. In addition, <code>eeg_</code>/<code>ch_</code> functions will also return an <code>eeg_lst</code> unless they have a suffix <code>_tbl</code> that indicates they return a data frame. In general, we will work with the <code>eeg_lst</code>, unless we want to modify the channels information (with <code><a href="../reference/channels_tbl.html">channels_tbl()</a></code>) or the events table containing markers, artifacts ans custom annotations (with <code>events_tbl</code>).</p>
</div>
<div class="section level2">
<h2 id="a-practical-example-the-n170-effect">A practical example: the N170 effect<a class="anchor" aria-label="anchor" href="#a-practical-example-the-n170-effect"></a>
</h2>
<p>Here, I exemplify the use of <em>eeguana</em> with raw EEG data exported in the format of BrainVision 1.0. The data belong to a simple experiment where a participant was presented 100 faces and 100 assorted images in random order. The task of the experiment was to mentally count the number of faces.</p>
<p>First we download the data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run the following or just download the files from raw_faces folder in https://osf.io/tbwvz/</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/" class="external-link">httr</a></span><span class="op">)</span>
<span class="fu"><a href="https://httr.r-lib.org/reference/GET.html" class="external-link">GET</a></span><span class="op">(</span><span class="st">"https://osf.io/wv5hp//?action=download"</span>,
  <span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html" class="external-link">write_disk</a></span><span class="op">(</span><span class="st">"./s1_faces.vhdr"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
  <span class="fu"><a href="https://httr.r-lib.org/reference/progress.html" class="external-link">progress</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://httr.r-lib.org/reference/GET.html" class="external-link">GET</a></span><span class="op">(</span><span class="st">"https://osf.io/c8wea//?action=download"</span>,
  <span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html" class="external-link">write_disk</a></span><span class="op">(</span><span class="st">"./s1_faces.vmrk"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
  <span class="fu"><a href="https://httr.r-lib.org/reference/progress.html" class="external-link">progress</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://httr.r-lib.org/reference/GET.html" class="external-link">GET</a></span><span class="op">(</span><span class="st">"https://osf.io/uhsde//?action=download"</span>,
  <span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html" class="external-link">write_disk</a></span><span class="op">(</span><span class="st">"./s1_faces.eeg"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
  <span class="fu"><a href="https://httr.r-lib.org/reference/progress.html" class="external-link">progress</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>BrainVision 1.0 exports three files: <code>s1_faces.vhdr</code>, <code>s1_faces.vmrk</code>, and <code>s1_faces.eeg</code>. The file <code>s1_faces.vhdr</code> contains the metadata and links to the other two files, <code>s1_faces.vmrk</code> contains the triggers and other events in the samples, and <code>s1_faces.eeg</code> contains the signals at every sample for every channel recorded.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bnicenboim/eeguana" class="external-link">eeguana</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># ICA will always find the same components</span></code></pre></div>
<p>We first need to read the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_vhdr.html">read_vhdr</a></span><span class="op">(</span><span class="st">"s1_faces.vhdr"</span><span class="op">)</span>
<span class="co">#&gt; # Reading file s1_faces.vhdr...</span>
<span class="co">#&gt; # Data from ./s1_faces.eeg was read.</span>
<span class="co">#&gt; # Data from 1 segment(s) and 34 channels was loaded.</span>
<span class="co">#&gt; # Object size in memory 113.4 Mb</span></code></pre></div>
<p>The function <code><a href="../reference/read_vhdr.html">read_vhdr()</a></code> creates a list with data frames for the signal, events, segments information, and incorporates in its attributes generic EEG information.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces</span>
<span class="co">#&gt; # EEG data:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Signal table:</span>
<span class="co">#&gt;         .id .sample       Fp1       Fpz       Fp2        F7         F3</span>
<span class="co">#&gt;      1:   1       1 -17878.56 -8921.395 -14028.81 -284.2541 -1378.1467</span>
<span class="co">#&gt;      2:   1       2 -17903.75 -8948.022 -14056.53 -303.9134 -1400.6560</span>
<span class="co">#&gt;      3:   1       3 -17916.55 -8961.906 -14070.91 -307.1683 -1407.8466</span>
<span class="co">#&gt;      4:   1       4 -17918.17 -8963.691 -14068.63 -299.8859 -1401.9985</span>
<span class="co">#&gt;      5:   1       5 -17917.71 -8965.658 -14069.16 -294.7915 -1401.2996</span>
<span class="co">#&gt;     ---                                                               </span>
<span class="co">#&gt; 424484:   1  424484 -16094.71 -8234.730 -13505.21  609.9043  -236.9552</span>
<span class="co">#&gt; 424485:   1  424485 -16140.11 -8280.301 -13547.56  603.1918  -311.0485</span>
<span class="co">#&gt; 424486:   1  424486 -16145.24 -8275.078 -13528.22  541.3096  -291.0218</span>
<span class="co">#&gt; 424487:   1  424487 -16165.22 -8294.479 -13546.50  467.7130  -302.0740</span>
<span class="co">#&gt; 424488:   1  424488 -16167.39 -8305.199 -13561.12  576.3062  -319.2688</span>
<span class="co">#&gt;                Fz       F4         F8       FC5       FC1       FC2       FC6</span>
<span class="co">#&gt;      1: -8077.128 1167.489 -1663.4490 -2315.080 -9040.689 -795.0549 -3665.146</span>
<span class="co">#&gt;      2: -8101.660 1145.292 -1685.9034 -2338.859 -9064.137 -816.1298 -3688.133</span>
<span class="co">#&gt;      3: -8114.331 1138.028 -1691.4203 -2343.475 -9071.438 -823.4675 -3690.046</span>
<span class="co">#&gt;      4: -8116.114 1139.702 -1683.0713 -2333.746 -9065.608 -817.9690 -3681.642</span>
<span class="co">#&gt;      5: -8119.442 1136.373 -1684.2664 -2326.648 -9061.397 -817.2882 -3679.563</span>
<span class="co">#&gt;     ---                                                                      </span>
<span class="co">#&gt; 424484: -7991.669 1977.146  -162.8618 -2290.511 -9349.164 -318.8641 -2805.395</span>
<span class="co">#&gt; 424485: -8045.019 1938.122  -183.0542 -2424.133 -9410.679 -364.1038 -2833.090</span>
<span class="co">#&gt; 424486: -8032.237 1965.358  -132.3712 -2291.431 -9379.728 -342.3297 -2811.445</span>
<span class="co">#&gt; 424487: -8052.393 1930.877  -180.4978 -2361.589 -9381.456 -358.2924 -2868.325</span>
<span class="co">#&gt; 424488: -8065.579 1927.474  -188.0929 -2368.595 -9409.171 -363.8277 -2853.797</span>
<span class="co">#&gt;         M1        T7        C3         Cz        C4         T8        M2</span>
<span class="co">#&gt;      1:  0 -5156.998 -2466.320 -1568.4097 -4427.577 -10351.511 -1845.363</span>
<span class="co">#&gt;      2:  0 -5184.417 -2490.411 -1591.3053 -4450.049 -10372.402 -1850.862</span>
<span class="co">#&gt;      3:  0 -5186.146 -2495.726 -1597.7970 -4454.775 -10378.323 -1845.087</span>
<span class="co">#&gt;      4:  0 -5174.358 -2487.358 -1591.5627 -4449.590 -10373.983 -1836.370</span>
<span class="co">#&gt;      5:  0 -5170.146 -2481.878 -1588.5833 -4446.334 -10370.489 -1841.961</span>
<span class="co">#&gt;     ---                                                                 </span>
<span class="co">#&gt; 424484:  0 -3703.158 -2301.288  -395.4219 -2952.459  -9502.499 -2128.771</span>
<span class="co">#&gt; 424485:  0 -3834.959 -2372.439  -444.3945 -2994.426  -9465.224 -2179.546</span>
<span class="co">#&gt; 424486:  0 -3773.260 -2312.064  -419.6414 -2975.410  -9389.198 -2153.340</span>
<span class="co">#&gt; 424487:  0 -3746.392 -2304.304  -426.3353 -2986.242  -9369.264 -2141.644</span>
<span class="co">#&gt; 424488:  0 -3615.768 -2358.720  -437.9209 -2984.145  -9521.864 -2130.978</span>
<span class="co">#&gt;               CP5       CP1        CP2       CP6        P7        P3         Pz</span>
<span class="co">#&gt;      1: -8938.128 -4755.838 -1369.6688 -1729.708 -7513.455 -8512.474 -537.63159</span>
<span class="co">#&gt;      2: -8963.231 -4778.917 -1391.3324 -1750.029 -7535.836 -8533.438 -557.97095</span>
<span class="co">#&gt;      3: -8969.171 -4784.986 -1397.7506 -1757.532 -7541.739 -8537.741 -561.55725</span>
<span class="co">#&gt;      4: -8957.989 -4775.938 -1391.9026 -1754.553 -7530.282 -8529.099 -552.78510</span>
<span class="co">#&gt;      5: -8950.726 -4772.205 -1388.7207 -1755.197 -7524.361 -8523.562 -549.19885</span>
<span class="co">#&gt;     ---                                                                        </span>
<span class="co">#&gt; 424484: -8037.571 -4200.332  -677.7635 -1046.501 -5433.473 -8150.485  -34.94090</span>
<span class="co">#&gt; 424485: -8083.840 -4253.405  -721.7708 -1080.431 -5470.565 -8197.932  -79.35287</span>
<span class="co">#&gt; 424486: -8027.603 -4225.636  -702.5348 -1048.874 -5474.501 -8173.215  -60.83399</span>
<span class="co">#&gt; 424487: -8046.398 -4230.160  -709.1735 -1040.856 -5488.533 -8182.244  -64.40166</span>
<span class="co">#&gt; 424488: -8060.742 -4244.541  -712.0606 -1053.931 -5478.491 -8187.780  -69.53255</span>
<span class="co">#&gt;                 P4        P8       POz        O1        Oz        O2      HEOG</span>
<span class="co">#&gt;      1:  -99.10343 -875.6397 -852.6708 -4117.080 -1950.149 -817.4540 -5006.420</span>
<span class="co">#&gt;      2: -117.14455 -892.3933 -871.1710 -4136.997 -1965.578 -825.3984 -5027.017</span>
<span class="co">#&gt;      3: -122.82701 -892.9816 -873.9114 -4138.725 -1965.137 -824.5893 -5037.775</span>
<span class="co">#&gt;      4: -117.75130 -886.6740 -866.0771 -4126.606 -1957.450 -823.7434 -5033.031</span>
<span class="co">#&gt;      5: -117.82441 -885.3681 -865.5070 -4127.543 -1967.270 -834.0415 -5031.210</span>
<span class="co">#&gt;     ---                                                                       </span>
<span class="co">#&gt; 424484:  496.89807 -182.1897 -304.2810 -2730.290 -1170.744  -67.8408 -3137.224</span>
<span class="co">#&gt; 424485:  458.84891 -229.4153 -345.6953 -2777.571 -1209.235 -104.1242 -3216.466</span>
<span class="co">#&gt; 424486:  476.24600 -226.5095 -342.8815 -2794.121 -1232.792 -135.4974 -3136.874</span>
<span class="co">#&gt; 424487:  471.66693 -247.6580 -343.4331 -2790.444 -1224.516 -152.9679 -3105.096</span>
<span class="co">#&gt; 424488:  475.47369 -247.5108 -350.5685 -2804.640 -1245.077 -186.8792 -3162.988</span>
<span class="co">#&gt;              VEOG</span>
<span class="co">#&gt;      1: -9116.806</span>
<span class="co">#&gt;      2: -9133.780</span>
<span class="co">#&gt;      3: -9138.781</span>
<span class="co">#&gt;      4: -9134.222</span>
<span class="co">#&gt;      5: -9139.996</span>
<span class="co">#&gt;     ---          </span>
<span class="co">#&gt; 424484: -8591.514</span>
<span class="co">#&gt; 424485: -8672.283</span>
<span class="co">#&gt; 424486: -8648.578</span>
<span class="co">#&gt; 424487: -8658.159</span>
<span class="co">#&gt; 424488: -8660.311</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Events table:</span>
<span class="co">#&gt;      .id       .type .description .initial .final .channel</span>
<span class="co">#&gt;   1:   1 New Segment                     1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   2:   1    Stimulus         s111    10528  10528     &lt;NA&gt;</span>
<span class="co">#&gt;   3:   1    Stimulus         s130    10742  10742     &lt;NA&gt;</span>
<span class="co">#&gt;   4:   1    Stimulus          s71    11175  11175     &lt;NA&gt;</span>
<span class="co">#&gt;   5:   1    Stimulus         s130    12806  12806     &lt;NA&gt;</span>
<span class="co">#&gt;  ---                                                      </span>
<span class="co">#&gt; 401:   1    Stimulus         s130   411197 411197     &lt;NA&gt;</span>
<span class="co">#&gt; 402:   1    Stimulus          s71   411469 411469     &lt;NA&gt;</span>
<span class="co">#&gt; 403:   1    Stimulus         s121   412943 412943     &lt;NA&gt;</span>
<span class="co">#&gt; 404:   1    Stimulus         s122   412966 412966     &lt;NA&gt;</span>
<span class="co">#&gt; 405:   1    Stimulus         s102   412989 412989     &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Segments table:</span>
<span class="co">#&gt;    .id    .recording segment</span>
<span class="co">#&gt; 1:   1 s1_faces.vhdr       1</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">faces</span><span class="op">)</span>
<span class="co">#&gt; # EEG data:</span>
<span class="co">#&gt; # Sampling rate: 512 Hz.</span>
<span class="co">#&gt; # Size in memory: 113.4 Mb.</span>
<span class="co">#&gt; # Total duration: 00:13:49.</span>
<span class="co">#&gt; # Summary of segments</span>
<span class="co">#&gt;       .recording n_segments n_incomplete</span>
<span class="co">#&gt; 1: s1_faces.vhdr          1            0</span>
<span class="co">#&gt; # Summary of events</span>
<span class="co">#&gt;          .type .description   n</span>
<span class="co">#&gt; 1: New Segment                1</span>
<span class="co">#&gt; 2:    Stimulus         s102   1</span>
<span class="co">#&gt; 3:    Stimulus         s111   1</span>
<span class="co">#&gt; 4:    Stimulus         s121   1</span>
<span class="co">#&gt; 5:    Stimulus         s122   1</span>
<span class="co">#&gt; 6:    Stimulus         s130 200</span>
<span class="co">#&gt; 7:    Stimulus          s70 100</span>
<span class="co">#&gt; 8:    Stimulus          s71 100</span></code></pre></div>
<p>We see that there is no electrode positions in the object, but since we know that the layout was a standard 10/20, we’ll add this layout to the object, using the dataset <code>layout_32_1020</code>. This is required to be able to create topographic plots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/channels_tbl.html">channels_tbl</a></span><span class="op">(</span><span class="va">faces</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 34 × 11</span></span>
<span class="co">#&gt;    .channel number .reference resolution unit     radius theta   phi    .x    .y</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Fp1      Ch1    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Fpz      Ch2    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Fp2      Ch3    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> F7       Ch4    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> F3       Ch5    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Fz       Ch6    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> F4       Ch7    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> F8       Ch8    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FC5      Ch9    <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FC1      Ch10   <span style="color: #BB0000;">NA</span>                  1 microvo…     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 24 more rows, and 1 more variable: .z &lt;dbl&gt;</span></span>
<span class="co">## In case the order of the electrodes is different, we do a left_join instead of replacing the table:</span>
<span class="fu"><a href="../reference/channels_tbl.html">channels_tbl</a></span><span class="op">(</span><span class="va">faces</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="../reference/channels_tbl.html">channels_tbl</a></span><span class="op">(</span><span class="va">faces</span><span class="op">)</span>, <span class="va">.channel</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">layout_32_1020</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = ".channel"</span></code></pre></div>
<p>The plots that <strong>eeguana</strong> produce are <code>ggplot</code> objects that can be modified like regular <code>ggplot</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">faces</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"All the experiment"</span><span class="op">)</span>
<span class="co">#&gt; # Downsampling from 512Hz to 256Hz.</span>
<span class="co">#&gt; # Object size in memory 56.7 Mb</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<div class="section level3">
<h3 id="pre-processing">Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h3>
<div class="section level4">
<h4 id="rereferencing">Rereferencing<a class="anchor" aria-label="anchor" href="#rereferencing"></a>
</h4>
<p>In this dataset, the signal from all electrodes is monopolar and referenced to the left mastoid (M1). We want the signal (excluding the EOG channels) to be referenced to linked (left and right) mastoids (M1 and M2).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eeg_rereference.html">eeg_rereference</a></span><span class="op">(</span><span class="va">faces</span>, <span class="op">-</span><span class="va">VEOG</span>, <span class="op">-</span><span class="va">HEOG</span>, .ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h3>
<p>We apply a band pass filter of 0.1 to 30 Hz to all the channels except the EOG channels. We don’t segment yet, because discontinuities in the signal create artifacts on the edges.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filt.html">eeg_filt_band_pass</a></span><span class="op">(</span><span class="va">faces</span>, <span class="op">-</span><span class="va">HEOG</span>, <span class="op">-</span><span class="va">VEOG</span>, .freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; Setting up band-pass filter from 0.1 - 30 Hz</span>
<span class="co">#&gt; Width of the transition band at the low cut-off frequency is 0.1 Hz</span>
<span class="co">#&gt; Width of the transition band at the high cut-off frequency is 7.5 Hz</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ica">ICA<a class="anchor" aria-label="anchor" href="#ica"></a>
</h3>
<p>We want to apply ICA to as much data as possible, but to “representative” data: to data of the experiment and not when the participants were moving or reading the instructions. For the same reason, we want to the ignore artifacts that we are sure are not representing brain activity, because of the extreme amplitudes in the signal.</p>
<p>We first cut a large segment that excludes data before and after the experiment was ran using <code><a href="../reference/eeg_segment.html">eeg_segment()</a></code> (that is, only data from the marker “s111” to “s121”), and then we mark differences of 200 microvolts between peaks with <code><a href="../reference/eeg_artif.html">eeg_artif_minmax()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eeg_segment.html">eeg_segment</a></span><span class="op">(</span><span class="va">faces_filt</span>, <span class="va">.description</span> <span class="op">==</span> <span class="st">"s111"</span>, .end <span class="op">=</span> <span class="va">.description</span> <span class="op">==</span> <span class="st">"s121"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_artif.html">eeg_artif_minmax</a></span><span class="op">(</span><span class="op">-</span><span class="va">HEOG</span>, <span class="op">-</span><span class="va">VEOG</span>, .threshold <span class="op">=</span> <span class="fl">200</span>, .window <span class="op">=</span> <span class="fl">200</span>, .unit <span class="op">=</span> <span class="st">"ms"</span><span class="op">)</span>
<span class="co">#&gt; # Total of 1 segments found.</span>
<span class="co">#&gt; # Object size in memory 107.5 Mb after segmentation.</span>
<span class="co">#&gt; # Number of intervals with artifacts: 118</span></code></pre></div>
<p><code>eeg_artif_minimax()</code> only adds the artifacts in the events table and doesn’t modify the signal. We can have a look at the type of artifacts that were detected, by plotting the signal and the events with <code><a href="../reference/annotate_events.html">annotate_events()</a></code>. It would be a good idea to just check a couple of seconds of the signal, for that we use the dplyr-like function <code><a href="../reference/dplyr_verbs.html">eeg_filter()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_ls</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="op">-</span><span class="va">HEOG</span>, <span class="op">-</span><span class="va">VEOG</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/as_time.html">as_time</a></span><span class="op">(</span><span class="va">.sample</span>, .unit <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/between.html">between</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/annotate_events.html">annotate_events</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="co">#&gt; # Downsampling from 512Hz to 256Hz.</span>
<span class="co">#&gt; # Object size in memory 5.9 Mb</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>Now we can run ICA, removing the EOG and reference electrodes, and ignoring the artifacts.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## By default, it will ignore artifacts</span>
<span class="va">faces_ica</span> <span class="op">&lt;-</span> <span class="va">faces_ls</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_ica.html">eeg_ica</a></span><span class="op">(</span><span class="op">-</span><span class="va">HEOG</span>, <span class="op">-</span><span class="va">VEOG</span>, <span class="op">-</span><span class="va">M1</span>, <span class="op">-</span><span class="va">M2</span>, .method <span class="op">=</span> <span class="va">adapt_fast_ICA</span>, .ignore <span class="op">=</span> <span class="va">.type</span> <span class="op">==</span> <span class="st">"artifact"</span><span class="op">)</span>
<span class="co">#&gt; # ICA is being done using adapt_fast_ICA...</span>
<span class="co">#&gt; # ICA took 4.36 mins</span></code></pre></div>
<p>We can now check the different topographic plots of the ICAs with <code><a href="../reference/plot_components.html">plot_components()</a></code>, and their correlation with the EOG channels looking a the summary of the object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_ica</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/plot_components.html">plot_components</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/eeg_ica_summary_tbl.html">eeg_ica_summary_tbl</a></span><span class="op">(</span><span class="va">faces_ica</span><span class="op">)</span>
<span class="co">#&gt; EOG channels detected as: HEOG, VEOG</span>
<span class="co">#&gt; # Downsampling from 512Hz to 256Hz.</span>
<span class="co">#&gt; # Object size in memory 53.8 Mb</span>
<span class="co">#&gt;        .recording  EOG  .ICA           cor          var</span>
<span class="co">#&gt;  1: s1_faces.vhdr VEOG  ICA1  0.3098529965 0.3387882911</span>
<span class="co">#&gt;  2: s1_faces.vhdr HEOG  ICA1 -0.0001132202 0.3387882911</span>
<span class="co">#&gt;  3: s1_faces.vhdr VEOG ICA29  0.0371242658 0.1793728208</span>
<span class="co">#&gt;  4: s1_faces.vhdr HEOG ICA29 -0.0026311737 0.1793728208</span>
<span class="co">#&gt;  5: s1_faces.vhdr VEOG ICA12  0.0504623472 0.0921613172</span>
<span class="co">#&gt;  6: s1_faces.vhdr HEOG ICA12  0.0111921456 0.0921613172</span>
<span class="co">#&gt;  7: s1_faces.vhdr VEOG ICA22  0.0219244495 0.0764852219</span>
<span class="co">#&gt;  8: s1_faces.vhdr HEOG ICA22 -0.0038381089 0.0764852219</span>
<span class="co">#&gt;  9: s1_faces.vhdr VEOG ICA15 -0.0414988976 0.0742544737</span>
<span class="co">#&gt; 10: s1_faces.vhdr HEOG ICA15 -0.0106037734 0.0742544737</span>
<span class="co">#&gt; 11: s1_faces.vhdr VEOG ICA20  0.0125608407 0.0516777429</span>
<span class="co">#&gt; 12: s1_faces.vhdr HEOG ICA20 -0.0009543525 0.0516777429</span>
<span class="co">#&gt; 13: s1_faces.vhdr VEOG ICA21  0.0165618940 0.0409542971</span>
<span class="co">#&gt; 14: s1_faces.vhdr HEOG ICA21  0.0084487520 0.0409542971</span>
<span class="co">#&gt; 15: s1_faces.vhdr VEOG ICA27 -0.0105839169 0.0305187652</span>
<span class="co">#&gt; 16: s1_faces.vhdr HEOG ICA27 -0.0033444192 0.0305187652</span>
<span class="co">#&gt; 17: s1_faces.vhdr HEOG  ICA9 -0.0104469531 0.0164572491</span>
<span class="co">#&gt; 18: s1_faces.vhdr VEOG  ICA9 -0.0083677586 0.0164572491</span>
<span class="co">#&gt; 19: s1_faces.vhdr VEOG  ICA4 -0.0207375364 0.0129502676</span>
<span class="co">#&gt; 20: s1_faces.vhdr HEOG  ICA4 -0.0073950796 0.0129502676</span>
<span class="co">#&gt; 21: s1_faces.vhdr HEOG ICA14  0.0042436080 0.0102705876</span>
<span class="co">#&gt; 22: s1_faces.vhdr VEOG ICA14  0.0005749188 0.0102705876</span>
<span class="co">#&gt; 23: s1_faces.vhdr VEOG ICA30  0.0110418330 0.0095064661</span>
<span class="co">#&gt; 24: s1_faces.vhdr HEOG ICA30  0.0010016696 0.0095064661</span>
<span class="co">#&gt; 25: s1_faces.vhdr VEOG ICA16 -0.0106949512 0.0091724722</span>
<span class="co">#&gt; 26: s1_faces.vhdr HEOG ICA16  0.0015450154 0.0091724722</span>
<span class="co">#&gt; 27: s1_faces.vhdr HEOG  ICA3 -0.0050633279 0.0079903661</span>
<span class="co">#&gt; 28: s1_faces.vhdr VEOG  ICA3 -0.0050068321 0.0079903661</span>
<span class="co">#&gt; 29: s1_faces.vhdr VEOG ICA10 -0.0033766588 0.0056931388</span>
<span class="co">#&gt; 30: s1_faces.vhdr HEOG ICA10 -0.0017528404 0.0056931388</span>
<span class="co">#&gt; 31: s1_faces.vhdr VEOG  ICA7  0.0169725199 0.0050171542</span>
<span class="co">#&gt; 32: s1_faces.vhdr HEOG  ICA7  0.0018673074 0.0050171542</span>
<span class="co">#&gt; 33: s1_faces.vhdr VEOG ICA25 -0.0142125420 0.0049558227</span>
<span class="co">#&gt; 34: s1_faces.vhdr HEOG ICA25 -0.0045579878 0.0049558227</span>
<span class="co">#&gt; 35: s1_faces.vhdr VEOG ICA24 -0.0114044328 0.0049425692</span>
<span class="co">#&gt; 36: s1_faces.vhdr HEOG ICA24  0.0009826717 0.0049425692</span>
<span class="co">#&gt; 37: s1_faces.vhdr VEOG ICA17  0.0044156334 0.0046351754</span>
<span class="co">#&gt; 38: s1_faces.vhdr HEOG ICA17 -0.0017506491 0.0046351754</span>
<span class="co">#&gt; 39: s1_faces.vhdr HEOG ICA11  0.0112879181 0.0038519218</span>
<span class="co">#&gt; 40: s1_faces.vhdr VEOG ICA11  0.0084937376 0.0038519218</span>
<span class="co">#&gt; 41: s1_faces.vhdr HEOG ICA23 -0.0037578749 0.0037972577</span>
<span class="co">#&gt; 42: s1_faces.vhdr VEOG ICA23  0.0005125567 0.0037972577</span>
<span class="co">#&gt; 43: s1_faces.vhdr VEOG ICA28  0.0076387797 0.0037188109</span>
<span class="co">#&gt; 44: s1_faces.vhdr HEOG ICA28  0.0074422369 0.0037188109</span>
<span class="co">#&gt; 45: s1_faces.vhdr VEOG ICA19  0.0098485902 0.0036669539</span>
<span class="co">#&gt; 46: s1_faces.vhdr HEOG ICA19  0.0010267467 0.0036669539</span>
<span class="co">#&gt; 47: s1_faces.vhdr VEOG ICA18 -0.0240453113 0.0033468363</span>
<span class="co">#&gt; 48: s1_faces.vhdr HEOG ICA18 -0.0128927944 0.0033468363</span>
<span class="co">#&gt; 49: s1_faces.vhdr HEOG  ICA2  0.0582359080 0.0017491995</span>
<span class="co">#&gt; 50: s1_faces.vhdr VEOG  ICA2  0.0283023293 0.0017491995</span>
<span class="co">#&gt; 51: s1_faces.vhdr VEOG  ICA6 -0.0180898570 0.0011369635</span>
<span class="co">#&gt; 52: s1_faces.vhdr HEOG  ICA6 -0.0030368843 0.0011369635</span>
<span class="co">#&gt; 53: s1_faces.vhdr VEOG ICA13 -0.0052967610 0.0008897330</span>
<span class="co">#&gt; 54: s1_faces.vhdr HEOG ICA13  0.0033931878 0.0008897330</span>
<span class="co">#&gt; 55: s1_faces.vhdr VEOG  ICA5 -0.0198211092 0.0006759164</span>
<span class="co">#&gt; 56: s1_faces.vhdr HEOG  ICA5 -0.0177982275 0.0006759164</span>
<span class="co">#&gt; 57: s1_faces.vhdr VEOG  ICA8  0.0087774305 0.0004218802</span>
<span class="co">#&gt; 58: s1_faces.vhdr HEOG  ICA8 -0.0050821925 0.0004218802</span>
<span class="co">#&gt; 59: s1_faces.vhdr HEOG ICA26 -0.0157882732 0.0001131337</span>
<span class="co">#&gt; 60: s1_faces.vhdr VEOG ICA26 -0.0119805273 0.0001131337</span>
<span class="co">#&gt;        .recording  EOG  .ICA           cor          var</span></code></pre></div>
<p>We’ll look closer at the ICA that are more likely to be related to eye movements, and we’ll compare with signals that look like blinks and saccades:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_ica</span> <span class="op">&lt;-</span> <span class="va">faces_ica</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_artif.html">eeg_artif_step</a></span><span class="op">(</span><span class="va">HEOG</span>, <span class="va">VEOG</span>, .threshold <span class="op">=</span> <span class="fl">30</span>, .window <span class="op">=</span> <span class="fl">200</span>, .unit <span class="op">=</span> <span class="st">"ms"</span>, .freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_artif.html">eeg_artif_peak</a></span><span class="op">(</span><span class="va">VEOG</span>, .threshold <span class="op">=</span> <span class="fl">100</span>, .freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Setting up band-pass filter from 1 - 10 Hz</span>
<span class="co">#&gt; Width of the transition band at the low cut-off frequency is 1 Hz</span>
<span class="co">#&gt; Width of the transition band at the high cut-off frequency is 2.5 Hz</span>
<span class="co">#&gt; # Number of intervals with artifacts: 407</span>
<span class="co">#&gt; Setting up band-pass filter from 1 - 10 Hz</span>
<span class="co">#&gt; Width of the transition band at the low cut-off frequency is 1 Hz</span>
<span class="co">#&gt; Width of the transition band at the high cut-off frequency is 2.5 Hz</span>
<span class="co">#&gt; # Number of intervals with artifacts: 158</span></code></pre></div>
<p>In order to investigate the ICA, we are using an experimental function not yet exported (that’s why we use the :::). This function will probably converted into a shiny app. It’s possible to get the same plots by using a combination of <code>plot_topo</code>, <code>eeg_ica_show</code>, <code>eeg_ica_summary_tbl</code>, and some <code>ggplot</code> and <code>cowplot</code> functions.</p>
<p>We’ll see how the components explaining the most variance and most correlated to the EOG channels behave:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#samples with blinks</span>
<span class="va">s_peaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/events_tbl.html">events_tbl</a></span><span class="op">(</span><span class="va">faces_ica</span><span class="op">)</span>,  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_starts</a></span><span class="op">(</span><span class="va">.description</span>, <span class="st">"peak"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">.initial</span><span class="op">)</span>
<span class="fu">eeguana</span><span class="fu">:::</span><span class="fu">plot_ica.eeg_ica_lst</span><span class="op">(</span><span class="va">faces_ica</span>, samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">s_peaks</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">2000</span>,<span class="va">s_peaks</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in eeguana:::plot_ica.eeg_ica_lst(faces_ica, samples = seq(s_peaks[1]</span>
<span class="co">#&gt; - : This is an experimental function, and it might change or disappear in the</span>
<span class="co">#&gt; future. (Or it might be transformed into a shinyapp)</span>
<span class="co">#&gt; Using recording: s1_faces.vhdr</span>
<span class="co">#&gt; EOG channels detected as: HEOG, VEOG</span>
<span class="co">#&gt; Calculating the correlation of ICA components with filtered EOG channels...</span>
<span class="co">#&gt; Setting up band-pass filter from 0.1 - 30 Hz</span>
<span class="co">#&gt; Width of the transition band at the low cut-off frequency is 0.1 Hz</span>
<span class="co">#&gt; Width of the transition band at the high cut-off frequency is 7.5 Hz</span>
<span class="co">#&gt; EOG channels detected as: HEOG, VEOG</span>
<span class="co">#&gt; # Downsampling from 512Hz to 256Hz.</span>
<span class="co">#&gt; # Object size in memory 53.9 Mb</span>
<span class="co">#&gt; The following columns of signal_tbl are not channels (or ICA components): ICA1ICA29ICA12ICA22ICA15ICA20ICA21ICA27ICA9ICA4ICA14ICA30ICA16ICA3ICA10ICA7</span>
<span class="co">#&gt; * To build a channel use `channel_dbl()` function, e.g. channel_dbl(0) to populate the table with a channel containing 0 microvolts.</span>
<span class="co">#&gt; * To copy the structure of an existing channel one can do `new_ch = existing_channel * 0 + ...`</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-11-1.png" width="90%"></p>
<p>The clearest ones is ICA5, and so we’ll just remove that one.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_icaed</span> <span class="op">&lt;-</span> <span class="va">faces_ica</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_ica_keep.html">eeg_ica_keep</a></span><span class="op">(</span><span class="op">-</span><span class="va">ICA5</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/as_eeg_lst.html">as_eeg_lst</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Now we’ll segment the data to appropriate check if there are still artifacts.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/events_tbl.html">events_tbl</a></span><span class="op">(</span><span class="va">faces_icaed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/events_tbl.html">events_tbl</a></span><span class="op">(</span><span class="va">faces_icaed</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">.type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"artifact"</span><span class="op">)</span>

<span class="va">faces_seg</span> <span class="op">&lt;-</span> <span class="va">faces_icaed</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="op">-</span><span class="va">description</span>, <span class="op">-</span><span class="va">type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_segment.html">eeg_segment</a></span><span class="op">(</span><span class="va">.description</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s70"</span>, <span class="st">"s71"</span><span class="op">)</span>, .lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.1</span>, <span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # Total of 200 segments found.</span>
<span class="co">#&gt; # Object size in memory 16.5 Mb after segmentation.</span>

<span class="va">faces_seg_artif</span> <span class="op">&lt;-</span> <span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_artif.html">eeg_artif_minmax</a></span><span class="op">(</span><span class="op">-</span><span class="va">HEOG</span>, <span class="op">-</span><span class="va">VEOG</span>, .threshold <span class="op">=</span> <span class="fl">100</span>, .window <span class="op">=</span> <span class="fl">150</span>, .unit <span class="op">=</span> <span class="st">"ms"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_artif.html">eeg_artif_step</a></span><span class="op">(</span><span class="op">-</span><span class="va">HEOG</span>, <span class="op">-</span><span class="va">VEOG</span>, .threshold <span class="op">=</span> <span class="fl">50</span>, .window <span class="op">=</span> <span class="fl">200</span>, .unit <span class="op">=</span> <span class="st">"ms"</span><span class="op">)</span>
<span class="co">#&gt; # Number of intervals with artifacts: 47</span>
<span class="co">#&gt; # Number of intervals with artifacts: 109</span>

<span class="co">## extracts the ids of the segments with artifacts</span>
<span class="va">bad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/events_tbl.html">events_tbl</a></span><span class="op">(</span><span class="va">faces_seg_artif</span><span class="op">)</span>, <span class="va">.type</span> <span class="op">==</span> <span class="st">"artifact"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">.id</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## Show the segment with artifact and one before and after:</span>
<span class="va">faces_seg_artif</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_filter</a></span><span class="op">(</span><span class="va">.id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bad</span><span class="op">-</span><span class="fl">1</span>, <span class="va">bad</span>, <span class="va">bad</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="op">-</span><span class="va">VEOG</span>, <span class="op">-</span><span class="va">HEOG</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/annotate_events.html">annotate_events</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="co">#&gt; # Downsampling from 512Hz to 256Hz.</span>
<span class="co">#&gt; # Object size in memory 3.1 Mb</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">faces_seg</span> <span class="op">&lt;-</span> <span class="va">faces_seg_artif</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/eeg_events_to_NA.html">eeg_events_to_NA</a></span><span class="op">(</span><span class="va">.type</span> <span class="op">==</span> <span class="st">"artifact"</span>, .entire_seg <span class="op">=</span> <span class="cn">TRUE</span>, .all_chs <span class="op">=</span> <span class="cn">FALSE</span>, .drop_events <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">faces_seg</span><span class="op">)</span>
<span class="co">#&gt; # EEG data:</span>
<span class="co">#&gt; # Sampling rate: 512 Hz.</span>
<span class="co">#&gt; # Size in memory: 16.5 Mb.</span>
<span class="co">#&gt; # Total duration: 00:02:00.</span>
<span class="co">#&gt; # Summary of segments</span>
<span class="co">#&gt;       .recording n_segments n_incomplete</span>
<span class="co">#&gt; 1: s1_faces.vhdr        200           36</span>
<span class="co">#&gt; # Summary of events</span>
<span class="co">#&gt;       .type .description   n</span>
<span class="co">#&gt; 1: Stimulus          s70 100</span>
<span class="co">#&gt; 2: Stimulus          s71 100</span></code></pre></div>
<p>Finally, we can baseline the segments:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_seg</span> <span class="op">&lt;-</span> <span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/eeg_baseline.html">eeg_baseline</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p>We edit the segmentation information and add more descriptive labels.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_seg</span> <span class="op">&lt;-</span> <span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_mutate</a></span><span class="op">(</span>
    condition <span class="op">=</span>
      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">description</span> <span class="op">==</span> <span class="st">"s70"</span>, <span class="st">"faces"</span>, <span class="st">"non-faces"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="op">-</span><span class="va">type</span><span class="op">)</span>

<span class="va">faces_seg</span>
<span class="co">#&gt; # EEG data:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Signal table:</span>
<span class="co">#&gt;        .id .sample        Fp1       Fpz         Fp2         F7        F3</span>
<span class="co">#&gt;     1:   1     -50 -1.3857821  2.506070 -0.39055047 -0.2702236  2.594597</span>
<span class="co">#&gt;     2:   1     -49 -1.1274544  2.458017 -0.86212567  0.2474072  2.493453</span>
<span class="co">#&gt;     3:   1     -48 -0.5343263  2.663517 -0.90710409  1.0784217  2.590668</span>
<span class="co">#&gt;     4:   1     -47  0.2857946  3.060287 -0.57329056  2.1213955  2.852347</span>
<span class="co">#&gt;     5:   1     -46  1.2293715  3.591034  0.08130834  3.2767737  3.249672</span>
<span class="co">#&gt;    ---                                                                  </span>
<span class="co">#&gt; 61596: 200     253 17.4224854 21.813508 24.78382742 10.3744498 13.869748</span>
<span class="co">#&gt; 61597: 200     254 15.8996178 19.758151 22.22385059  8.5421730 12.264111</span>
<span class="co">#&gt; 61598: 200     255 14.4494759 17.598267 19.55794290  6.7753923 10.723693</span>
<span class="co">#&gt; 61599: 200     256 13.0353956 15.411060 16.91034524  5.0949942  9.243335</span>
<span class="co">#&gt; 61600: 200     257 11.5917030 13.255274 14.37007893  3.5016414  7.781486</span>
<span class="co">#&gt;                Fz         F4         F8        FC5        FC1        FC2</span>
<span class="co">#&gt;     1:  4.0451583  1.7219231 -3.5039627  0.9787852 -2.0510342  -3.593674</span>
<span class="co">#&gt;     2:  3.6861069  0.8413479 -3.1991905  1.1860153 -1.9148800  -4.337968</span>
<span class="co">#&gt;     3:  3.5518103  0.2082478 -2.4387662  1.4601071 -1.5049328  -4.729796</span>
<span class="co">#&gt;     4:  3.5879868 -0.1693005 -1.2959864  1.7821618 -0.8930260  -4.774948</span>
<span class="co">#&gt;     5:  3.7455969 -0.2872642  0.1330329  2.1556332 -0.1488171  -4.487544</span>
<span class="co">#&gt;    ---                                                                  </span>
<span class="co">#&gt; 61596:  1.3319750 -0.6831873 11.1774884 10.7691806  2.9732808 -11.764766</span>
<span class="co">#&gt; 61597: -0.1735025 -1.2701982  9.3928745  9.0858958  1.1318271 -12.803980</span>
<span class="co">#&gt; 61598: -1.5290985 -1.8599549  7.7521538  7.3407476 -0.8911383 -13.812016</span>
<span class="co">#&gt; 61599: -2.7185015 -2.4173607  6.3184340  5.5647397 -3.0334966 -14.752929</span>
<span class="co">#&gt; 61600: -3.7619017 -2.9298388  5.1173740  3.7693201 -5.2449621 -15.608629</span>
<span class="co">#&gt;               FC6        M1       T7         C3         Cz         C4</span>
<span class="co">#&gt;     1: -2.3777222 -2.030141 7.844882 -2.0730707  -6.499112  -1.123574</span>
<span class="co">#&gt;     2: -2.0384178 -1.922150 8.106049 -2.4121601  -6.855300  -1.877160</span>
<span class="co">#&gt;     3: -1.3275775 -1.785010 7.959406 -2.6624122  -6.839697  -2.539230</span>
<span class="co">#&gt;     4: -0.3222386 -1.654058 7.424104 -2.7796995  -6.468312  -3.055360</span>
<span class="co">#&gt;     5:  0.8980345 -1.545839 6.573076 -2.7107143  -5.770478  -3.356224</span>
<span class="co">#&gt;    ---                                                               </span>
<span class="co">#&gt; 61596: -3.1732950  4.310870 7.422743  5.1400476  -8.944902 -27.861372</span>
<span class="co">#&gt; 61597: -4.8199959  4.454409 6.981073  3.1227075 -10.823009 -29.156160</span>
<span class="co">#&gt; 61598: -6.4644513  4.482182 6.378309  0.9284449 -12.880319 -30.420984</span>
<span class="co">#&gt; 61599: -8.0073182  4.394789 5.544417 -1.3414921 -14.995715 -31.592958</span>
<span class="co">#&gt; 61600: -9.3687803  4.203761 4.430326 -3.6043362 -17.054014 -32.612199</span>
<span class="co">#&gt;                T8        M2        CP5        CP1        CP2         CP6</span>
<span class="co">#&gt;     1:   4.286885  2.030141  2.1693528 -5.5593362  -4.009697   1.9388819</span>
<span class="co">#&gt;     2:   5.612280  1.922150  1.4923855 -5.9252277  -4.807572   1.0801445</span>
<span class="co">#&gt;     3:   7.012211  1.785010  0.6896479 -6.0851911  -5.388034   0.2764139</span>
<span class="co">#&gt;     4:   8.228028  1.654058 -0.1284975 -6.0165472  -5.712001  -0.4261893</span>
<span class="co">#&gt;     5:   9.003441  1.545839 -0.8348813 -5.6954771  -5.744126  -0.9713783</span>
<span class="co">#&gt;    ---                                                                  </span>
<span class="co">#&gt; 61596: -20.202095 -4.310870  8.1591128  0.8839634 -25.424284 -22.8770129</span>
<span class="co">#&gt; 61597: -21.826681 -4.454409  6.7768896 -1.1238025 -27.206824 -24.4041437</span>
<span class="co">#&gt; 61598: -23.059555 -4.482182  5.1485130 -3.3667121 -28.961846 -25.9626922</span>
<span class="co">#&gt; 61599: -23.874749 -4.394789  3.3451701 -5.7015560 -30.566857 -27.5070119</span>
<span class="co">#&gt; 61600: -24.273419 -4.203761  1.4328467 -7.9929327 -31.907547 -28.9667789</span>
<span class="co">#&gt;               P7        P3         Pz          P4         P8        POz</span>
<span class="co">#&gt;     1: -2.004791 -2.738479  -3.441219  -0.7111998   0.360825 -1.4932577</span>
<span class="co">#&gt;     2: -2.909541 -3.530474  -4.318017  -1.7703446  -2.238023 -2.9233947</span>
<span class="co">#&gt;     3: -3.554971 -4.168055  -5.063847  -2.6760206  -4.638534 -4.2104023</span>
<span class="co">#&gt;     4: -3.870379 -4.568174  -5.618316  -3.3489155  -6.544204 -5.2289503</span>
<span class="co">#&gt;     5: -3.820075 -4.656549  -5.920637  -3.7163777  -7.706011 -5.8678723</span>
<span class="co">#&gt;    ---                                                                 </span>
<span class="co">#&gt; 61596:  6.304326  8.837763  -5.383201 -20.9371203 -17.772999  1.0674391</span>
<span class="co">#&gt; 61597:  5.658292  7.238310  -7.165942 -22.0902450 -18.136742 -0.2756034</span>
<span class="co">#&gt; 61598:  4.614197  5.418532  -9.012603 -23.1112292 -17.711772 -1.6783652</span>
<span class="co">#&gt; 61599:  3.284832  3.487614 -10.795947 -23.9501039 -16.484018 -3.0459904</span>
<span class="co">#&gt; 61600:  1.796745  1.549002 -12.398985 -24.5656352 -14.531866 -4.2979851</span>
<span class="co">#&gt;               O1         Oz         O2       HEOG       VEOG</span>
<span class="co">#&gt;     1: -3.352182 -0.4981054  1.3250303  -8.172153  -4.070868</span>
<span class="co">#&gt;     2: -4.744847 -2.1798164 -0.4597926 -15.399203 -10.286688</span>
<span class="co">#&gt;     3: -6.005732 -3.8014299 -2.2051573 -17.091586  -4.218329</span>
<span class="co">#&gt;     4: -7.006345 -5.1896533 -3.7050433 -22.001254  -2.728094</span>
<span class="co">#&gt;     5: -7.635930 -6.1835499 -4.7667551 -14.368930   3.892999</span>
<span class="co">#&gt;    ---                                                      </span>
<span class="co">#&gt; 61596:  7.113869  1.5908573 -0.5937514  40.897595 104.275391</span>
<span class="co">#&gt; 61597:  6.142690  0.7273414  0.3127146  19.307751  67.568359</span>
<span class="co">#&gt; 61598:  4.970325 -0.2404153  0.9526069  24.585583  66.189453</span>
<span class="co">#&gt; 61599:  3.731996 -1.2390464  1.2760794   4.779675  43.698242</span>
<span class="co">#&gt; 61600:  2.541580 -2.2117730  1.2452397  -2.815540  36.453125</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Events table:</span>
<span class="co">#&gt;      .id    .type .description .initial .final .channel</span>
<span class="co">#&gt;   1:   1 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   2:   2 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   3:   3 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   4:   4 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   5:   5 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;  ---                                                   </span>
<span class="co">#&gt; 196: 196 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 197: 197 Stimulus          s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 198: 198 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 199: 199 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 200: 200 Stimulus          s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Segments table:</span>
<span class="co">#&gt;      .id    .recording segment description condition</span>
<span class="co">#&gt;   1:   1 s1_faces.vhdr       1         s71 non-faces</span>
<span class="co">#&gt;   2:   2 s1_faces.vhdr       2         s71 non-faces</span>
<span class="co">#&gt;   3:   3 s1_faces.vhdr       3         s71 non-faces</span>
<span class="co">#&gt;   4:   4 s1_faces.vhdr       4         s71 non-faces</span>
<span class="co">#&gt;   5:   5 s1_faces.vhdr       5         s71 non-faces</span>
<span class="co">#&gt;  ---                                                </span>
<span class="co">#&gt; 196: 196 s1_faces.vhdr     196         s71 non-faces</span>
<span class="co">#&gt; 197: 197 s1_faces.vhdr     197         s70     faces</span>
<span class="co">#&gt; 198: 198 s1_faces.vhdr     198         s71 non-faces</span>
<span class="co">#&gt; 199: 199 s1_faces.vhdr     199         s71 non-faces</span>
<span class="co">#&gt; 200: 200 s1_faces.vhdr     200         s71 non-faces</span></code></pre></div>
<p>With some <code>ggplot</code> skills, we can create customized plots. <code>ggplot</code> is overloaded to work on an <code>eeg_lst</code> by first downsampling the signal when necessary, and converting it to a long-format data frame that is feed into <code>ggplot</code>. This object can then be customized. (Notice that the channels, or component names are in a <code>.key</code> column and their amplitude in <code>.value</code> column, and instead of samples there are now <code>.time</code> in seconds).</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## ggplot uses internally a table that looks like this:</span>
<span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_filter</a></span><span class="op">(</span><span class="va">.id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 31,416 × 8</span></span>
<span class="co">#&gt;      .time   .id .recording    segment description condition .key  .value</span>
<span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> -<span style="color: #BB0000;">0.099</span><span style="color: #BB0000; text-decoration: underline;">6</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1   -<span style="color: #BB0000;">1.39</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">7</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1   -<span style="color: #BB0000;">1.13</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">7</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1   -<span style="color: #BB0000;">0.534</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> -<span style="color: #BB0000;">0.093</span><span style="color: #BB0000; text-decoration: underline;">8</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    0.286</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">8</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    1.23 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">8</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    2.21 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> -<span style="color: #BB0000;">0.087</span><span style="color: #BB0000; text-decoration: underline;">9</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    3.15 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> -<span style="color: #BB0000;">0.085</span><span style="color: #BB0000; text-decoration: underline;">9</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    4.02 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">0</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    4.80 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> -<span style="color: #BB0000;">0.082</span><span style="color: #BB0000; text-decoration: underline;">0</span>     1 s1_faces.vhdr       1 s71         non-faces Fp1    5.48 </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 31,406 more rows</span></span>

<span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="va">O1</span>, <span class="va">O2</span>, <span class="va">P7</span>, <span class="va">P8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span>, y <span class="op">=</span> <span class="va">.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">.id</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>
    fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span>, alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">1.5</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.key</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">.17</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
<p>We can see here the N170 component in the faces condition for the average trial on a single participant. We can investigate the signal by averaging the channels of the occipital and parietal lobes using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">transmute()</a></code>, and the special function, <code><a href="../reference/chs_mean.html">chs_mean()</a></code>, a wrapper for <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans()</a></code>, which takes as arguments the relevant channels and whether missing values should be omitted from the calculations.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_transmute</a></span><span class="op">(</span>
    Occipital <span class="op">=</span> <span class="fu"><a href="../reference/chs_mean.html">chs_mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/dplyr_verbs.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"O"</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co">#O1, O2, Oz</span>
    Parietal <span class="op">=</span> <span class="fu"><a href="../reference/chs_mean.html">chs_mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/dplyr_verbs.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"O"</span><span class="op">)</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># P3, P4, P7, P8, Pz</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span>, y <span class="op">=</span> <span class="va">.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">.id</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>
    fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span>, alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">1</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.key</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
<p>We can also calculate the ERPs and then plot them in their layout (and we’ll add the same theme that plot uses for <code>eeg_lst</code>s):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ERP_faces</span> <span class="op">&lt;-</span> <span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_group_by</a></span><span class="op">(</span><span class="va">.sample</span>, <span class="va">condition</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_summarize</a></span><span class="op">(</span><span class="fu"><a href="../reference/dplyr_verbs.html">across_ch</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
  
<span class="va">ERP_plot</span> <span class="op">&lt;-</span> <span class="va">ERP_faces</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span>, y <span class="op">=</span> <span class="va">.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.key</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"ERPs for faces vs non-faces"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/theme_eeguana.html">theme_eeguana</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">ERP_plot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/plot_in_layout.html">plot_in_layout</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/layout-1.png" width="100%"></p>
<p>Another possibility is to create a topographic plot of the two conditions, by first making segments that include only the interval .1-.2 <em>s</em> after the onset of the stimuli, creating a table with interpolated amplitudes and using the ggplot wrapper <code><a href="../reference/plot_topo.html">plot_topo()</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/between.html">between</a></span><span class="op">(</span><span class="fu"><a href="../reference/as_time.html">as_time</a></span><span class="op">(</span><span class="va">.sample</span>, .unit <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>, <span class="fl">.1</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_group_by</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_summarize</a></span><span class="op">(</span><span class="fu"><a href="../reference/dplyr_verbs.html">across_ch</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/plot_topo.html">plot_topo</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/annotate_head.html">annotate_head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/topo-1.png" width="100%"></p>
<p>For more specialized plots or analyses, it might be necessary to extract the data in long data frame format first. Even though, we can do this without transforming the object, here, we transform the data first and then we visualize independent t-tests at every electrode and time point.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="va">O1</span>, <span class="va">O2</span>, <span class="va">P7</span>, <span class="va">P8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co"># We can use regular dplyr functions now</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">.key</span>, <span class="va">.time</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    `t-value` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span>
      <span class="va">.value</span><span class="op">[</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"faces"</span><span class="op">]</span>,
      <span class="va">.value</span><span class="op">[</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"non-faces"</span><span class="op">]</span>
    <span class="op">)</span><span class="op">$</span><span class="va">statistic</span>
  <span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by '.key'. You can override using the `.groups` argument.</span>

<span class="va">df</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,232 × 3</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   .key [4]</span></span>
<span class="co">#&gt;    .key    .time `t-value`</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> O1    -<span style="color: #BB0000;">0.099</span><span style="color: #BB0000; text-decoration: underline;">6</span>    0.231 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> O1    -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">7</span>    0.303 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> O1    -<span style="color: #BB0000;">0.095</span><span style="color: #BB0000; text-decoration: underline;">7</span>    0.352 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> O1    -<span style="color: #BB0000;">0.093</span><span style="color: #BB0000; text-decoration: underline;">8</span>    0.366 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> O1    -<span style="color: #BB0000;">0.091</span><span style="color: #BB0000; text-decoration: underline;">8</span>    0.334 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> O1    -<span style="color: #BB0000;">0.089</span><span style="color: #BB0000; text-decoration: underline;">8</span>    0.251 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> O1    -<span style="color: #BB0000;">0.087</span><span style="color: #BB0000; text-decoration: underline;">9</span>    0.111 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> O1    -<span style="color: #BB0000;">0.085</span><span style="color: #BB0000; text-decoration: underline;">9</span>   -<span style="color: #BB0000;">0.090</span><span style="color: #BB0000; text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> O1    -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.354</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> O1    -<span style="color: #BB0000;">0.082</span><span style="color: #BB0000; text-decoration: underline;">0</span>   -<span style="color: #BB0000;">0.664</span> </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1,222 more rows</span></span></code></pre></div>
<p>Then we just load the data frame into <code>ggplot</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span>, y <span class="op">=</span> <span class="va">`t-value`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.key</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-19-1.png" width="100%"></p>
<p>However, this can be also done in the without transforming the <code>eeg_lst</code> object:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">faces_seg_t</span> <span class="op">&lt;-</span>
  <span class="va">faces_seg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_select</a></span><span class="op">(</span><span class="va">O1</span>, <span class="va">O2</span>, <span class="va">P7</span>, <span class="va">P8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_group_by</a></span><span class="op">(</span><span class="va">.sample</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/dplyr_verbs.html">eeg_summarize</a></span><span class="op">(</span><span class="fu"><a href="../reference/dplyr_verbs.html">across_ch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>t <span class="op">=</span>  <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span>
    <span class="va">.</span><span class="op">[</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"faces"</span><span class="op">]</span>,
    <span class="va">.</span><span class="op">[</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"non-faces"</span><span class="op">]</span>
  <span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">faces_seg_t</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.time</span>, y <span class="op">=</span> <span class="va">.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">.id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span>, alpha <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">.key</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-20-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://www.ling.uni-potsdam.de/~nicenboim/" class="external-link">Bruno Nicenboim</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

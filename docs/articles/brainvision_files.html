<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction - Manipulating a clean EEG file exported from BrainVision 2.0 • eeguana</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction - Manipulating a clean EEG file exported from BrainVision 2.0">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eeguana</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/brainvision_files.html">Introduction - Manipulating a clean EEG file exported from BrainVision 2.0</a>
    </li>
    <li>
      <a href="../articles/preprocessing_erp.html">Preprocessing of EEG data and computing ERPs (Fieldtrip tutorial)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bnicenboim/eeguana">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction - Manipulating a clean EEG file exported from BrainVision 2.0</h1>
                        <h4 class="author">Bruno Nicenboim</h4>
            
            <h4 class="date">2019-05-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bnicenboim/eeguana/blob/master/vignettes/brainvision_files.Rmd"><code>vignettes/brainvision_files.Rmd</code></a></small>
      <div class="hidden name"><code>brainvision_files.Rmd</code></div>

    </div>

    
    
<p><em>eeguana</em> provides a framework for manipulating EEG data with <em>dplyr</em>-based function (e.g., <code>mutate</code>, <code>filter</code>, <code>summarize</code>) extended to a new class <code>eeg_lst</code>. In addition, it provides other EEG-specialized functions, and <code>ggplot</code> wrapper functions. The new class is inspired by tidyverse principles but it’s not really “tidy” (due to space considerations), it’s a list of (i) a wide table (<code>signal_tbl</code>) that contains the signal amplitudes at every sample point of the EEG, (ii) an events table with information about markers (or triggers), blinks and other exported information, and (iii) a long table with experimental information, such as participant (<code>recording</code>), conditions, etc.</p>
<p>Here, I exemplify the use of <em>eeguana</em> with (pre-processed) EEG data from BrainVision 2.0. The data belong to a simple experiment where a participant was presented 100 faces and 100 assorted images in random order. The task of the experiment was to mentally count the number of faces.</p>
<p>First we download the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"http://www.ling.uni-potsdam.de/~nicenboim/files/faces.vhdr"</span>, 
               <span class="dt">mode=</span><span class="st">"wb"</span>, <span class="dt">destfile=</span><span class="st">"faces.vhdr"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"http://www.ling.uni-potsdam.de/~nicenboim/files/faces.vmrk"</span>, 
               <span class="dt">mode=</span><span class="st">"wb"</span>, <span class="dt">destfile=</span><span class="st">"faces.vmrk"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/download.file">download.file</a></span>(<span class="st">"http://www.ling.uni-potsdam.de/~nicenboim/files/faces.dat"</span>, 
               <span class="dt">mode=</span><span class="st">"wb"</span>, <span class="dt">destfile=</span><span class="st">"faces.dat"</span>)</code></pre></div>
<p>BrainVision 2.0 exports three files: <code>faces.vhdr</code>, <code>faces.vmrk</code>, and <code>faces.dat</code>. The file <code>faces.vhdr</code> contains the metadata and links to the other two files, <code>faces.vmrk</code> contains the triggers and other events in the samples, and <code>faces.dat</code> contains the signals at every sample for every channel recorded.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(eeguana)
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.5.3</span></code></pre></div>
<p>We first need to read the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces &lt;-<span class="st"> </span><span class="kw">read_vhdr</span>(<span class="st">"faces.vhdr"</span>)
<span class="co">#&gt; # Data from faces.dat was read.</span>
<span class="co">#&gt; # Data from 1 segment(s) and 34 channels was loaded.</span>
<span class="co">#&gt; # Object size in memory 140.5 Mb</span></code></pre></div>
<p>The function <code>read_vhdr()</code> creates a list with data frames for the signal, events, segments information, and incorporates in its attributes generic EEG information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces
<span class="co">#&gt; $signal</span>
<span class="co">#&gt;         .id .sample_id        Fp1        Fpz        Fp2         F7         F3</span>
<span class="co">#&gt;      1:   1          1  -4.270188 -12.496757  -8.512611  5.8104863  0.7987084</span>
<span class="co">#&gt;      2:   1          2  -5.986778 -11.261559  -8.302858  4.4670320 -0.4558482</span>
<span class="co">#&gt;      3:   1          3  -6.580773  -9.333183  -7.679757  3.7081127 -1.8434987</span>
<span class="co">#&gt;      4:   1          4  -5.896090  -6.184696  -6.079263  3.9488502 -2.6274934</span>
<span class="co">#&gt;      5:   1          5  -5.349657  -2.581047  -3.960115  4.6228004 -2.9634132</span>
<span class="co">#&gt;     ---                                                                      </span>
<span class="co">#&gt; 525203:   1     525203 -19.180754 -14.482754 -11.880928 -3.0353870 -3.5060143</span>
<span class="co">#&gt; 525204:   1     525204 -14.669420 -10.800195  -7.822333 -0.2864416 -2.9062314</span>
<span class="co">#&gt; 525205:   1     525205 -10.086312  -7.376223  -4.007497  2.3745189 -2.2934551</span>
<span class="co">#&gt; 525206:   1     525206  -5.963717  -6.318047  -2.550068  4.0785899 -2.8591332</span>
<span class="co">#&gt; 525207:   1     525207  -2.811746  -9.569276  -5.257495  3.9431772 -4.7773180</span>
<span class="co">#&gt;                 Fz        F4          F8        FC5       FC1       FC2</span>
<span class="co">#&gt;      1: -3.7944875 -7.004565  -9.5905457 -5.5008502 -1.040939 -5.750594</span>
<span class="co">#&gt;      2: -3.9204431 -7.312232 -10.1968956 -8.2559958 -1.625572 -6.205832</span>
<span class="co">#&gt;      3: -3.6854007 -7.325179 -10.5801353 -8.9441166 -2.496611 -6.225702</span>
<span class="co">#&gt;      4: -2.2696950 -6.544898 -10.5005941 -5.3551817 -3.275798 -5.792281</span>
<span class="co">#&gt;      5: -0.1724038 -5.449733 -10.2940083 -0.5347631 -3.816769 -5.539208</span>
<span class="co">#&gt;     ---                                                                </span>
<span class="co">#&gt; 525203: -5.1268702 -3.885933   1.3387113 -6.0354300 -3.429955 -1.821500</span>
<span class="co">#&gt; 525204: -4.6610451 -3.474034   0.5267539 -5.6796050 -3.269526 -1.967095</span>
<span class="co">#&gt; 525205: -3.9615459 -2.554780  -0.1948199 -5.2791243 -2.709156 -1.333362</span>
<span class="co">#&gt; 525206: -4.5113835 -2.396278  -0.8776174 -5.5155010 -2.732390 -1.006990</span>
<span class="co">#&gt; 525207: -7.2133980 -4.015337  -1.6118808 -7.1379128 -3.719297 -1.199275</span>
<span class="co">#&gt;               FC6         M1         T7        C3        Cz         C4</span>
<span class="co">#&gt;      1: -9.455340  3.2116241 -2.5749669 -3.198639 -7.162738 -6.0244598</span>
<span class="co">#&gt;      2: -9.701509  1.5566816 -2.1688442 -3.223826 -7.327467 -4.7359419</span>
<span class="co">#&gt;      3: -9.615817  0.4754019 -1.5235398 -4.196370 -7.618096 -3.2705278</span>
<span class="co">#&gt;      4: -8.781445 -0.3485098 -0.1197605 -6.155464 -7.683692 -1.2953618</span>
<span class="co">#&gt;      5: -7.758235 -1.6416440  1.5852079 -8.072474 -7.589663  0.9121451</span>
<span class="co">#&gt;     ---                                                               </span>
<span class="co">#&gt; 525203: -1.574225 -3.9028225 -9.0984344 -2.281207 -1.244156 -2.6202018</span>
<span class="co">#&gt; 525204: -2.711437 -1.4479842 -8.1386690 -1.984105 -1.888554 -3.1423230</span>
<span class="co">#&gt; 525205: -3.477794  0.6584158 -7.0688133 -1.378137 -2.078016 -2.8522072</span>
<span class="co">#&gt; 525206: -4.265026  2.0143995 -6.4578338 -1.488095 -2.738976 -3.3436871</span>
<span class="co">#&gt; 525207: -6.290535  3.4945364 -7.3460751 -2.911523 -4.274473 -5.8495107</span>
<span class="co">#&gt;                T8         M2       CP5       CP1        CP2        CP6</span>
<span class="co">#&gt;      1: -4.771918 -3.2116241 -6.062939 -4.813977 -5.0018249 -8.6002913</span>
<span class="co">#&gt;      2: -3.939853 -1.5566816 -5.505422 -4.283286 -3.9824409 -6.4684544</span>
<span class="co">#&gt;      3: -3.285263 -0.4754019 -5.300730 -4.089828 -2.8778281 -4.4623995</span>
<span class="co">#&gt;      4: -2.399213  0.3485098 -5.378413 -4.206456 -1.4029371 -2.4144411</span>
<span class="co">#&gt;      5: -1.056782  1.6416440 -5.488734 -4.434868  0.3268354 -0.1063155</span>
<span class="co">#&gt;     ---                                                               </span>
<span class="co">#&gt; 525203: -3.093663  3.9028225 -8.155416 -3.549603 -3.7856157 -1.9837997</span>
<span class="co">#&gt; 525204: -2.935883  1.4479842 -6.898589 -3.393985 -4.0930557 -3.5452051</span>
<span class="co">#&gt; 525205: -3.875237 -0.6584158 -5.362293 -2.832092 -3.8660426 -4.0679202</span>
<span class="co">#&gt; 525206: -4.052106 -2.0143995 -4.340692 -2.890889 -4.3359194 -4.9113569</span>
<span class="co">#&gt; 525207: -4.504183 -3.4945364 -4.906254 -4.134459 -6.3578181 -7.4022784</span>
<span class="co">#&gt;                   P7        P3        Pz         P4         P8        POz</span>
<span class="co">#&gt;      1:  -6.72501945 -7.823194 -9.713374 -10.933434 -4.1939182 -13.021215</span>
<span class="co">#&gt;      2:  -4.19162369 -6.248482 -8.652735  -8.811299 -2.4914169 -10.943350</span>
<span class="co">#&gt;      3:  -1.97165060 -4.997821 -7.685406  -6.668526 -1.0310369  -8.963390</span>
<span class="co">#&gt;      4:  -0.09873655 -3.947244 -6.593503  -4.320339  0.6503686  -6.857091</span>
<span class="co">#&gt;      5:   1.68736827 -2.843956 -5.372189  -1.687156  2.8481901  -4.618455</span>
<span class="co">#&gt;     ---                                                                  </span>
<span class="co">#&gt; 525203: -17.43293571 -7.778884 -3.405085  -1.660518 -4.3979721  -7.370723</span>
<span class="co">#&gt; 525204: -14.93541336 -6.817270 -4.063128  -2.827326 -5.3324118  -7.889754</span>
<span class="co">#&gt; 525205: -12.36065578 -5.574656 -4.185033  -3.481713 -6.1155925  -7.927995</span>
<span class="co">#&gt; 525206: -10.60478783 -5.109689 -4.693735  -4.598518 -7.1271410  -8.352034</span>
<span class="co">#&gt; 525207: -11.30642700 -6.548401 -6.205623  -6.893994 -9.2952871  -9.975165</span>
<span class="co">#&gt;                 O1          Oz         O2       EOGV      EOGH</span>
<span class="co">#&gt;      1:  -7.650791  -8.6958437  -8.901768 36.3205566  20.61859</span>
<span class="co">#&gt;      2:  -3.840688  -5.8336391  -6.211349 39.7541809  25.55089</span>
<span class="co">#&gt;      3:  -0.550869  -3.2353799  -3.810405 42.1534882  29.02995</span>
<span class="co">#&gt;      4:   2.178792  -0.7047617  -1.321697 44.8317413  30.14127</span>
<span class="co">#&gt;      5:   4.996092   2.2072635   1.650699 49.1988983  29.85255</span>
<span class="co">#&gt;     ---                                                       </span>
<span class="co">#&gt; 525203: -17.387997 -13.6087084 -10.443031  0.8650103 -12.82597</span>
<span class="co">#&gt; 525204: -15.422725 -14.4835081 -12.536522 -0.9290609 -14.95488</span>
<span class="co">#&gt; 525205: -13.746743 -15.2129507 -14.059873 -1.9016356 -14.81808</span>
<span class="co">#&gt; 525206: -13.172369 -16.1580162 -15.562737 -3.9798355 -12.73059</span>
<span class="co">#&gt; 525207: -14.335607 -17.8692055 -17.643250 -9.1380615 -12.55048</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events</span>
<span class="co">#&gt;       .id         type description .initial .final .channel</span>
<span class="co">#&gt;    1:   1  New Segment                    1      1     &lt;NA&gt;</span>
<span class="co">#&gt;    2:   1 Bad Interval Bad Min-Max     2158   2895      Fp1</span>
<span class="co">#&gt;    3:   1 Bad Interval Bad Min-Max     2161   2891      Fp2</span>
<span class="co">#&gt;    4:   1 Bad Interval Bad Min-Max     2162   2890      Fpz</span>
<span class="co">#&gt;    5:   1 Bad Interval Bad Min-Max     2173   2861       F8</span>
<span class="co">#&gt;   ---                                                      </span>
<span class="co">#&gt; 4272:   1 Bad Interval Bad Min-Max   524692 524895       P8</span>
<span class="co">#&gt; 4273:   1 Bad Interval Bad Min-Max   524725 524992      FC5</span>
<span class="co">#&gt; 4274:   1 Bad Interval Bad Min-Max   524777 525122       P7</span>
<span class="co">#&gt; 4275:   1 Bad Interval Bad Min-Max   524983 525155       Cz</span>
<span class="co">#&gt; 4276:   1 Bad Interval Bad Min-Max   525073 525207       O2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $segments</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;     .id recording  segment</span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;        &lt;int&gt;</span>
<span class="co">#&gt; 1     1 faces.vhdr       1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "eeg_lst"</span>
<span class="co">#&gt; attr(,"vars")</span>
<span class="co">#&gt; character(0)</span></code></pre></div>
<p>It provides a summary:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(faces)
<span class="co">#&gt; # EEG data (eeg_lst) from the following channels:</span>
<span class="co">#&gt;     .channel type .reference resolution      unit radius theta phi    .x    .y</span>
<span class="co">#&gt;  1:      Fp1  Ch1     avim12         NA microvolt      1   -90 -72 -0.31  0.95</span>
<span class="co">#&gt;  2:      Fpz  Ch2     avim12         NA microvolt      1    90  90  0.00  1.00</span>
<span class="co">#&gt;  3:      Fp2  Ch3     avim12         NA microvolt      1    90  72  0.31  0.95</span>
<span class="co">#&gt;  4:       F7  Ch4     avim12         NA microvolt      1   -90 -36 -0.81  0.59</span>
<span class="co">#&gt;  5:       F3  Ch5     avim12         NA microvolt      1   -60 -51 -0.55  0.67</span>
<span class="co">#&gt;  6:       Fz  Ch6     avim12         NA microvolt      1    45  90  0.00  0.71</span>
<span class="co">#&gt;  7:       F4  Ch7     avim12         NA microvolt      1    60  51  0.55  0.67</span>
<span class="co">#&gt;  8:       F8  Ch8     avim12         NA microvolt      1    90  36  0.81  0.59</span>
<span class="co">#&gt;  9:      FC5  Ch9     avim12         NA microvolt      1   -69 -21 -0.87  0.33</span>
<span class="co">#&gt; 10:      FC1 Ch10     avim12         NA microvolt      1   -31 -46 -0.36  0.37</span>
<span class="co">#&gt; 11:      FC2 Ch11     avim12         NA microvolt      1    31  46  0.36  0.37</span>
<span class="co">#&gt; 12:      FC6 Ch12     avim12         NA microvolt      1    69  21  0.87  0.33</span>
<span class="co">#&gt; 13:       M1 Ch13     avim12         NA microvolt      0     0   0    NA    NA</span>
<span class="co">#&gt; 14:       T7 Ch14     avim12         NA microvolt      1   -90   0 -1.00  0.00</span>
<span class="co">#&gt; 15:       C3 Ch15     avim12         NA microvolt      1   -45   0 -0.71  0.00</span>
<span class="co">#&gt; 16:       Cz Ch16     avim12         NA microvolt      1     0   0  0.00  0.00</span>
<span class="co">#&gt; 17:       C4 Ch17     avim12         NA microvolt      1    45   0  0.71  0.00</span>
<span class="co">#&gt; 18:       T8 Ch18     avim12         NA microvolt      1    90   0  1.00  0.00</span>
<span class="co">#&gt; 19:       M2 Ch19     avim12         NA microvolt      0     0   0    NA    NA</span>
<span class="co">#&gt; 20:      CP5 Ch20     avim12         NA microvolt      1   -69  21 -0.87 -0.33</span>
<span class="co">#&gt; 21:      CP1 Ch21     avim12         NA microvolt      1   -31  46 -0.36 -0.37</span>
<span class="co">#&gt; 22:      CP2 Ch22     avim12         NA microvolt      1    31 -46  0.36 -0.37</span>
<span class="co">#&gt; 23:      CP6 Ch23     avim12         NA microvolt      1    69 -21  0.87 -0.33</span>
<span class="co">#&gt; 24:       P7 Ch24     avim12         NA microvolt      1   -90  36 -0.81 -0.59</span>
<span class="co">#&gt; 25:       P3 Ch25     avim12         NA microvolt      1   -60  51 -0.55 -0.67</span>
<span class="co">#&gt; 26:       Pz Ch26     avim12         NA microvolt      1    45 -90  0.00 -0.71</span>
<span class="co">#&gt; 27:       P4 Ch27     avim12         NA microvolt      1    60 -51  0.55 -0.67</span>
<span class="co">#&gt; 28:       P8 Ch28     avim12         NA microvolt      1    90 -36  0.81 -0.59</span>
<span class="co">#&gt; 29:      POz Ch29     avim12         NA microvolt      1    67 -90  0.00 -0.92</span>
<span class="co">#&gt; 30:       O1 Ch30     avim12         NA microvolt      1   -90  72 -0.31 -0.95</span>
<span class="co">#&gt; 31:       Oz Ch31     avim12         NA microvolt      1    90 -90  0.00 -1.00</span>
<span class="co">#&gt; 32:       O2 Ch32     avim12         NA microvolt      1    90 -72  0.31 -0.95</span>
<span class="co">#&gt; 33:     EOGV Ch33                    NA microvolt      0     0   0    NA    NA</span>
<span class="co">#&gt; 34:     EOGH Ch34                    NA microvolt      0     0   0    NA    NA</span>
<span class="co">#&gt;     .channel type .reference resolution      unit radius theta phi    .x    .y</span>
<span class="co">#&gt;       .z</span>
<span class="co">#&gt;  1: 0.00</span>
<span class="co">#&gt;  2: 0.00</span>
<span class="co">#&gt;  3: 0.00</span>
<span class="co">#&gt;  4: 0.00</span>
<span class="co">#&gt;  5: 0.50</span>
<span class="co">#&gt;  6: 0.71</span>
<span class="co">#&gt;  7: 0.50</span>
<span class="co">#&gt;  8: 0.00</span>
<span class="co">#&gt;  9: 0.36</span>
<span class="co">#&gt; 10: 0.86</span>
<span class="co">#&gt; 11: 0.86</span>
<span class="co">#&gt; 12: 0.36</span>
<span class="co">#&gt; 13:   NA</span>
<span class="co">#&gt; 14: 0.00</span>
<span class="co">#&gt; 15: 0.71</span>
<span class="co">#&gt; 16: 1.00</span>
<span class="co">#&gt; 17: 0.71</span>
<span class="co">#&gt; 18: 0.00</span>
<span class="co">#&gt; 19:   NA</span>
<span class="co">#&gt; 20: 0.36</span>
<span class="co">#&gt; 21: 0.86</span>
<span class="co">#&gt; 22: 0.86</span>
<span class="co">#&gt; 23: 0.36</span>
<span class="co">#&gt; 24: 0.00</span>
<span class="co">#&gt; 25: 0.50</span>
<span class="co">#&gt; 26: 0.71</span>
<span class="co">#&gt; 27: 0.50</span>
<span class="co">#&gt; 28: 0.00</span>
<span class="co">#&gt; 29: 0.39</span>
<span class="co">#&gt; 30: 0.00</span>
<span class="co">#&gt; 31: 0.00</span>
<span class="co">#&gt; 32: 0.00</span>
<span class="co">#&gt; 33:   NA</span>
<span class="co">#&gt; 34:   NA</span>
<span class="co">#&gt;       .z</span>
<span class="co">#&gt; # Sampling rate: 500 Hz.</span>
<span class="co">#&gt; # Size in memory: 140.5 Mb.</span>
<span class="co">#&gt; # Total duration: 00:17:30.</span>
<span class="co">#&gt; # Summary of segments</span>
<span class="co">#&gt;     recording segment_n</span>
<span class="co">#&gt; 1: faces.vhdr         1</span>
<span class="co">#&gt; # Summary of events</span>
<span class="co">#&gt;             type description    n</span>
<span class="co">#&gt;  1: Bad Interval Bad Min-Max 3734</span>
<span class="co">#&gt;  2: Bad Interval    Multiple  105</span>
<span class="co">#&gt;  3:  New Segment                1</span>
<span class="co">#&gt;  4:     Stimulus        s101    1</span>
<span class="co">#&gt;  5:     Stimulus        s102    1</span>
<span class="co">#&gt;  6:     Stimulus        s111    1</span>
<span class="co">#&gt;  7:     Stimulus        s121    1</span>
<span class="co">#&gt;  8:     Stimulus        s122    1</span>
<span class="co">#&gt;  9:     Stimulus        s130  200</span>
<span class="co">#&gt; 10:     Stimulus          s5    1</span>
<span class="co">#&gt; 11:     Stimulus         s70  100</span>
<span class="co">#&gt; 12:     Stimulus         s71  100</span>
<span class="co">#&gt; 13:  UserDefined       Blink   30</span></code></pre></div>
<p>Furthermore, it allows for quick visualization.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(faces)
<span class="co">#&gt; # Downsampling from 500Hz to 6.25Hz.</span>
<span class="co">#&gt; # Using the following factor(s) q: 2, 10, 4</span>
<span class="co">#&gt; # Object size in memory 2 Mb</span></code></pre></div>
<p><img src="brainvision_files_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>The standard plots can be slightly customized using <code>ggplot</code> layers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(faces) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">500</span>,<span class="dv">500</span>))
<span class="co">#&gt; # Downsampling from 500Hz to 6.25Hz.</span>
<span class="co">#&gt; # Using the following factor(s) q: 2, 10, 4</span>
<span class="co">#&gt; # Object size in memory 2 Mb</span></code></pre></div>
<p><img src="brainvision_files_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>Some intervals were marked as “bad” by BrainVision, and so we’ll remove them from the data. We’ll also segment and baseline the data. In this experiment, the trigger “s70” was used for faces and “s71” for no faces. We’ll segment the data using these two triggers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces_segs &lt;-<span class="st"> </span>faces <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">               </span><span class="kw">eeg_segment</span>(description <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"s70"</span>, <span class="st">"s71"</span>), 
                        <span class="dt">lim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span>.<span class="dv">2</span>,.<span class="dv">25</span>)) <span class="op">%&gt;%</span>
<span class="st">               </span><span class="kw">eeg_events_to_NA</span>(type <span class="op">==</span><span class="st"> "Bad Interval"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">               </span><span class="kw">ch_baseline</span>()
<span class="co">#&gt; # Total of 200 segments found.</span>
<span class="co">#&gt; # Object size in memory 12.2 Mb after segmentation.</span></code></pre></div>
<p>We can also edit the segmentation information and add more descriptive labels. <em>eeguana</em> has wrappers for many <code>dplyr</code> commands for the EEG data (see <code>?`dplyr-eeguana`</code>). These commands always return an entire <code>eeg_lst</code> object so that they can be piped using <code>magrittr</code>’s pipe, <code>%&gt;%</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces_segs_some &lt;-<span class="st"> </span>faces_segs <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">                  </span><span class="kw">mutate</span>(<span class="dt">condition =</span>
                  <span class="kw">if_else</span>(description <span class="op">==</span><span class="st"> "s70"</span>, <span class="st">"faces"</span>, <span class="st">"non-faces"</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">select</span>(<span class="op">-</span>type)

faces_segs_some
<span class="co">#&gt; $signal</span>
<span class="co">#&gt;        .id .sample_id      Fp1      Fpz       Fp2        F7        F3        Fz</span>
<span class="co">#&gt;     1:   1        -99 3.000602 3.822540  1.676837  5.345215  8.526904  4.730365</span>
<span class="co">#&gt;     2:   1        -98 4.651500 5.966759  2.899244  6.229248 11.957867  6.160355</span>
<span class="co">#&gt;     3:   1        -97 5.636973 7.734169  3.360790  6.146507 12.643122  7.125668</span>
<span class="co">#&gt;     4:   1        -96 4.887103 7.093736  1.560090  4.679008 10.153717  6.335395</span>
<span class="co">#&gt;     5:   1        -95 1.679875 3.586631 -2.115480  1.817395  6.471601  4.633891</span>
<span class="co">#&gt;    ---                                                                         </span>
<span class="co">#&gt; 45196: 200        122       NA       NA        NA -6.226833 -6.164627 -8.134506</span>
<span class="co">#&gt; 45197: 200        123       NA       NA        NA -7.609634 -6.624886 -8.577490</span>
<span class="co">#&gt; 45198: 200        124       NA       NA        NA -8.355278 -7.320350 -8.860150</span>
<span class="co">#&gt; 45199: 200        125       NA       NA        NA -8.419843 -8.317026 -9.056007</span>
<span class="co">#&gt; 45200: 200        126       NA       NA        NA -8.219583 -9.290400 -9.426888</span>
<span class="co">#&gt;               F4         F8        FC5       FC1       FC2       FC6         M1</span>
<span class="co">#&gt;     1:  3.188497 -0.1089175  -3.644006  7.912477  3.989274  1.272626  0.2677516</span>
<span class="co">#&gt;     2:  3.994015 -0.8760965   1.023301  9.416551  4.667467  3.301379 -0.2832003</span>
<span class="co">#&gt;     3:  4.267825 -2.2046354   7.279726  9.103708  5.293130  3.712586 -0.7368386</span>
<span class="co">#&gt;     4:  3.259394 -3.9267309  10.369022  7.112526  4.947480  1.836436 -0.8240938</span>
<span class="co">#&gt;     5:  1.394350 -5.1243312  10.296667  4.968021  4.046026 -1.199115 -0.6874469</span>
<span class="co">#&gt;    ---                                                                         </span>
<span class="co">#&gt; 45196: -6.909568 -0.8537389  -9.798989 -7.777216 -9.401660 -6.067313 -6.4766435</span>
<span class="co">#&gt; 45197: -7.793821 -0.9486715 -10.705381 -8.119785 -9.315678 -7.353704 -6.6995262</span>
<span class="co">#&gt; 45198: -8.050289 -0.5816752 -11.125468 -8.373542 -9.178003 -8.296130 -6.9813064</span>
<span class="co">#&gt; 45199: -7.632708  0.1328152 -10.956071 -8.740564 -9.007817 -8.350711 -7.0623969</span>
<span class="co">#&gt; 45200: -7.286663  0.5260323 -10.897510 -9.636951 -8.939460 -7.994563 -7.0156692</span>
<span class="co">#&gt;               T7        C3         Cz          C4         T8         M2</span>
<span class="co">#&gt;     1: -3.057617 10.609308   5.917813   0.8313377 -10.315272 -0.2677516</span>
<span class="co">#&gt;     2: -1.562383 12.928541   6.262912   1.0666051 -10.356676  0.2832003</span>
<span class="co">#&gt;     3:  1.504318 11.542353   5.948693   1.9167381 -11.298820  0.7368386</span>
<span class="co">#&gt;     4:  5.022166  7.915255   4.986212   2.8912187 -11.997029  0.8240938</span>
<span class="co">#&gt;     5:  6.427537  4.484360   4.172830   3.3982225 -12.559875  0.6874469</span>
<span class="co">#&gt;    ---                                                                 </span>
<span class="co">#&gt; 45196: -8.022766 -6.429070 -10.872999  -8.3944751  -3.502227  6.4766435</span>
<span class="co">#&gt; 45197: -8.829075 -7.358996 -10.609312  -9.2848460  -4.407707  6.6995262</span>
<span class="co">#&gt; 45198: -9.287003 -8.015747 -10.252135  -9.7955848  -4.839347  6.9813064</span>
<span class="co">#&gt; 45199: -9.304779 -8.464732  -9.964297  -9.9221298  -4.811365  7.0623969</span>
<span class="co">#&gt; 45200: -9.483838 -9.494273 -10.028708 -10.5967504  -4.864176  7.0156692</span>
<span class="co">#&gt;              CP5        CP1       CP2       CP6        P7         P3        Pz</span>
<span class="co">#&gt;     1:  1.964691  6.7162759  3.262704 -7.399092 -5.496809  2.0440808  4.166571</span>
<span class="co">#&gt;     2:  4.404590  7.4449489  3.293858 -5.744716 -2.861829  3.2697255  4.204710</span>
<span class="co">#&gt;     3:  5.582302  7.1147640  3.475278 -3.493423  1.280905  4.4449736  4.435450</span>
<span class="co">#&gt;     4:  5.430152  6.1576960  3.890801 -1.759528  5.945641  5.2879867  4.639458</span>
<span class="co">#&gt;     5:  4.314408  5.2338812  4.307086 -1.050894  8.049101  5.4885453  4.919482</span>
<span class="co">#&gt;    ---                                                                        </span>
<span class="co">#&gt; 45196: -1.349851 -0.4762376 -5.722418 -3.533263  2.242977  0.7155832 -4.610498</span>
<span class="co">#&gt; 45197: -3.101862 -1.1596463 -6.534246 -4.621159 -0.126445 -0.6689793 -5.037940</span>
<span class="co">#&gt; 45198: -4.486185 -1.7303489 -6.932361 -5.494592 -2.238547 -1.8152691 -5.363847</span>
<span class="co">#&gt; 45199: -5.391058 -2.1837558 -7.031692 -6.007089 -3.761132 -2.4688984 -5.509579</span>
<span class="co">#&gt; 45200: -6.672053 -3.0703575 -7.622055 -6.492426 -5.677335 -3.4514109 -5.946858</span>
<span class="co">#&gt;                P4         P8        POz         O1        Oz         O2</span>
<span class="co">#&gt;     1: -0.0616881 -8.3880332 -0.3286116 -6.0260374 -5.461096 -4.2778666</span>
<span class="co">#&gt;     2:  0.5590584 -6.7958000  0.3093608 -2.6993167 -2.760820 -2.2311228</span>
<span class="co">#&gt;     3:  1.7226454 -4.7219687  1.9620757  1.8627557  1.137758  0.7749981</span>
<span class="co">#&gt;     4:  2.7629569 -3.0705338  3.7967925  5.8118551  4.439274  3.4188545</span>
<span class="co">#&gt;     5:  3.4599713 -1.9033555  5.3241937  8.0964449  6.621065  5.8291734</span>
<span class="co">#&gt;    ---                                                                 </span>
<span class="co">#&gt; 45196: -3.9528958  1.4214111 -4.3255999 -0.5402464 -4.114951 -0.3463787</span>
<span class="co">#&gt; 45197: -4.7200541  0.7046986 -4.7982240 -0.8443795 -3.887248 -0.4495586</span>
<span class="co">#&gt; 45198: -5.5482372 -0.2055778 -5.3792999 -2.0916432 -4.558462 -1.1659049</span>
<span class="co">#&gt; 45199: -6.1985716 -1.2616262 -5.9168708 -4.1249534 -6.119560 -2.5120736</span>
<span class="co">#&gt; 45200: -6.8952164 -1.9542868 -6.5737116 -6.4350015 -7.568655 -3.5681661</span>
<span class="co">#&gt;              EOGV      EOGH</span>
<span class="co">#&gt;     1:   6.783448  2.078419</span>
<span class="co">#&gt;     2:   6.625389  4.423636</span>
<span class="co">#&gt;     3:   7.371072  6.663611</span>
<span class="co">#&gt;     4:   9.326947  8.364970</span>
<span class="co">#&gt;     5:  11.692706  9.205865</span>
<span class="co">#&gt;    ---                     </span>
<span class="co">#&gt; 45196:  -8.905102 18.196424</span>
<span class="co">#&gt; 45197:  -9.181591 17.637968</span>
<span class="co">#&gt; 45198:  -8.742321 17.773702</span>
<span class="co">#&gt; 45199:  -9.108685 17.002721</span>
<span class="co">#&gt; 45200: -10.735058 15.214422</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events</span>
<span class="co">#&gt;      .id     type description .initial .final .channel</span>
<span class="co">#&gt;   1:   1 Stimulus         s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   2:   2 Stimulus         s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   3:   3 Stimulus         s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   4:   4 Stimulus         s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;   5:   5 Stimulus         s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt;  ---                                                  </span>
<span class="co">#&gt; 196: 196 Stimulus         s71        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 197: 197 Stimulus         s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 198: 198 Stimulus         s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 199: 199 Stimulus         s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; 200: 200 Stimulus         s70        1      1     &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $segments</span>
<span class="co">#&gt; # A tibble: 200 x 5</span>
<span class="co">#&gt;      .id recording  segment description condition</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;    </span>
<span class="co">#&gt;  1     1 faces.vhdr       1 s70         faces    </span>
<span class="co">#&gt;  2     2 faces.vhdr       2 s71         non-faces</span>
<span class="co">#&gt;  3     3 faces.vhdr       3 s71         non-faces</span>
<span class="co">#&gt;  4     4 faces.vhdr       4 s71         non-faces</span>
<span class="co">#&gt;  5     5 faces.vhdr       5 s70         faces    </span>
<span class="co">#&gt;  6     6 faces.vhdr       6 s71         non-faces</span>
<span class="co">#&gt;  7     7 faces.vhdr       7 s71         non-faces</span>
<span class="co">#&gt;  8     8 faces.vhdr       8 s70         faces    </span>
<span class="co">#&gt;  9     9 faces.vhdr       9 s70         faces    </span>
<span class="co">#&gt; 10    10 faces.vhdr      10 s70         faces    </span>
<span class="co">#&gt; # ... with 190 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "eeg_lst"</span>
<span class="co">#&gt; attr(,"vars")</span>
<span class="co">#&gt; character(0)</span></code></pre></div>
<p>With some <code>ggplot</code> skills, we can create customized plots. <code>plot_gg</code> downsamples the signals (by default), and converts them to a long-format data frame that is feed into <code>ggplot</code> object. This object can then be customized.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces_segs_some <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">select</span>(O1, O2, P7, P8) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">plot_gg</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">group =</span> .id, <span class="dt">color =</span> condition)) <span class="op">+</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">"mean"</span>, <span class="dt">geom =</span><span class="st">"line"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, 
                  <span class="kw">aes</span>(<span class="dt">color =</span> condition)) <span class="op">+</span>
<span class="st">                  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.source) <span class="op">+</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> .<span class="dv">17</span>, <span class="dt">linetype =</span> <span class="st">"dotted"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">                  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) </code></pre></div>
<p><img src="brainvision_files_files/figure-html/unnamed-chunk-8-1.png" width="100%"></p>
<p>The motivation for manipulating the data in the <code>eeg_lst</code> format and not transforming them directly to a data frame has to do with size considerations. In this case, the original file was 149 MB, converting it to a long format entails a lot of repetition and generates an object of 786 MB. While this will still work here, a long format quickly becomes prohibitive in real settings with longer recordings and with several subjects.</p>
<p>We can see here the N170 component in the faces condition for the average trial on a single participant. We can investigate the signal by averaging the channels of the occipital and parietal lobes using the capabilities inherited from <code>dplyr</code>, and the special function, <code>chs_mean()</code>, a wrapper for <code><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowMeans()</a></code>, which takes as arguments the relevant channels and whether missing values should be omitted from the calculations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces_segs_some <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">transmute</span>(<span class="dt">Occipital =</span> <span class="kw">chs_mean</span>(O1, O2, Oz, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                          <span class="dt">Parietal =</span> <span class="kw">chs_mean</span>(P3, P4, P7,  P8, Pz, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">plot_gg</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">                </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">group =</span> .id, <span class="dt">color =</span> condition)) <span class="op">+</span>
<span class="st">                </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">"mean"</span>, <span class="dt">geom =</span><span class="st">"line"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">1</span>, 
                  <span class="kw">aes</span>(<span class="dt">color =</span> condition)) <span class="op">+</span>
<span class="st">                </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.source) <span class="op">+</span><span class="st"> </span>
<span class="st">                </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) </code></pre></div>
<p><img src="brainvision_files_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
<p>We can also calculate the ERPs and then plot them in their layout:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ERP_faces &lt;-<span class="st"> </span>faces_segs_some <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(.sample_id, condition) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize_all_ch</span>(mean,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)

ERP_plot &lt;-<span class="st"> </span>ERP_faces <span class="op">%&gt;%</span>
<span class="st">                </span><span class="kw">plot_gg</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">                </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> condition)) <span class="op">+</span>
<span class="st">               </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.source) <span class="op">+</span><span class="st"> </span>
<span class="st">                </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"ERPs for faces vs non-faces"</span>) 

ERP_plot  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot_in_layout</span>() </code></pre></div>
<p><img src="brainvision_files_files/figure-html/layout-1.png" width="100%"></p>
<p>Another possibility is to create a topographic plot of the two conditions, by first making segments that include only the interval .1-.2 <em>s</em> after the onset of the stimuli, creating a table with interpolated amplitudes and using the ggplot wrapper <code>plot_topo()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces_segs_some <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(<span class="kw">between</span>(<span class="kw">as_time</span>(.sample_id, <span class="dt">unit =</span> <span class="st">"milliseconds"</span>),<span class="dv">100</span>,<span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                    </span><span class="kw">group_by</span>(condition) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">summarize_all_ch</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">plot_topo</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">annotate_head</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">                    </span><span class="kw">geom_contour</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_text</span>(<span class="dt">colour =</span> <span class="st">"black"</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">facet_grid</span>(<span class="op">~</span>condition)</code></pre></div>
<p><img src="brainvision_files_files/figure-html/topo-1.png" width="100%"></p>
<p>For more specialized plots or analyses, it might be necessary to extract the data in long data frame format first. For example, here, we visualize independent t-tests (or some other statistics) at every electrode and time point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>faces_segs_some <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">select</span>(O1, O2, P7, P8) <span class="op">%&gt;%</span>
<span class="st">      </span>as_tibble <span class="op">%&gt;%</span>
<span class="st">        </span><span class="co"># We can use regular dplyr functions now</span>
<span class="st">      </span><span class="kw">group_by</span>(.source, time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">summarize</span>(
        <span class="st">`</span><span class="dt">t-value</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(.value[condition <span class="op">==</span><span class="st"> "faces"</span>],
          .value[condition <span class="op">==</span><span class="st"> "non-faces"</span>])<span class="op">$</span>statistic)

df
<span class="co">#&gt; # A tibble: 904 x 3</span>
<span class="co">#&gt; # Groups:   .source [4]</span>
<span class="co">#&gt;    .source   time `t-value`</span>
<span class="co">#&gt;    &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 O1      -0.2        1.77</span>
<span class="co">#&gt;  2 O1      -0.198      1.56</span>
<span class="co">#&gt;  3 O1      -0.196      1.59</span>
<span class="co">#&gt;  4 O1      -0.194      1.65</span>
<span class="co">#&gt;  5 O1      -0.192      1.62</span>
<span class="co">#&gt;  6 O1      -0.19       1.49</span>
<span class="co">#&gt;  7 O1      -0.188      1.28</span>
<span class="co">#&gt;  8 O1      -0.186      1.12</span>
<span class="co">#&gt;  9 O1      -0.184      1.10</span>
<span class="co">#&gt; 10 O1      -0.182      1.20</span>
<span class="co">#&gt; # ... with 894 more rows</span></code></pre></div>
<p>Then we just load the data frame into <code>ggplot</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> <span class="st">`</span><span class="dt">t-value</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">                </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.source) </code></pre></div>
<p><img src="brainvision_files_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
<p>However, this can be also done in the without transforming the <code>eeg_lst</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">faces_segs_some_t &lt;-<span class="st"> </span>
<span class="st">  </span>faces_segs_some <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">select</span>(O1, O2, P7, P8) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">group_by</span>(.sample_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">summarize_all_ch</span>(<span class="kw">funs</span>(<span class="dt">t =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/t.test">t.test</a></span>(.[condition <span class="op">==</span><span class="st"> "faces"</span>],
          .[condition <span class="op">==</span><span class="st"> "non-faces"</span>])<span class="op">$</span>statistic))
<span class="co">#&gt; Warning: funs() is soft deprecated as of dplyr 0.8.0</span>
<span class="co">#&gt; please use list() instead</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Before:</span>
<span class="co">#&gt; funs(name = f(.)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # After: </span>
<span class="co">#&gt; list(name = ~f(.))</span>
<span class="co">#&gt; This warning is displayed once per session.</span>

  <span class="kw">plot_gg</span>(faces_segs_some_t) <span class="op">+</span><span class="st"> </span>
<span class="st">                </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">group =</span> .id)) <span class="op">+</span>
<span class="st">                </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">"mean"</span>, <span class="dt">geom =</span><span class="st">"line"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">                </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.source) <span class="op">+</span><span class="st"> </span>
<span class="st">                </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) </code></pre></div>
<p><img src="brainvision_files_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://www.ling.uni-potsdam.de/~nicenboim/">Bruno Nicenboim</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
